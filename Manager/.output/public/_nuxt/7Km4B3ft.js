import{r as i,aw as k,u as C,o as T,x as u,A as d,ay as o,y as e,J as p,aM as f,B as j,R as S,C as _,v as m}from"./BaPgrU-z.js";import{u as M}from"./DFqJgj2c.js";import{u as h,c as V}from"./CQ-QpSxo.js";import{b as N,S as B}from"./COsbiUZU.js";import"./DlAUqK2U.js";const E={class:"userAuth p-10"},F={class:"w-3/5 mx-auto border border-slate-600 rounded-md p-10"},R=e("div",{class:"pb-6"},[e("h1",{class:"text-3xl font-semibold text-left"}," Log In "),e("p",{class:"text-sm"},[_("Don't have an account? "),e("a",{class:"underline",href:"/signup"},"Create an account")])],-1),A={class:"w-full flex flex-row justify-between gap-4"},D={class:"w-1/2"},I={class:"mb-4"},L=e("label",{for:"email",class:"block text-sm font-bold mb-2"},"Email",-1),O={class:"mb-4"},$=e("label",{for:"password",class:"block text-sm font-bold mb-2"},"Password",-1),q={class:"flex items-center justify-between"},J=e("a",{href:"/signup",class:"underline"},"Sign up instead",-1),P={class:"w-1/2 flex flex-col justify-start items-center gap-10"},U=e("h1",{class:"text-3xl font-semibold text-center"}," Welcome to ManagerOrg ",-1),G={key:0,class:"w-full flex justify-center items-center"},Y={__name:"login",setup(W){M({title:"Log in",description:"Manager account creation page"});const r=h("token"),w=h("user_id"),c=i(null),b=k(),a=i(!1),v=C(),s=i({email:"",password:""}),y=async()=>{a.value=!0;try{const t=await $fetch("https://vitreous-bert-jordantimberlake-dd542edd.koyeb.app/api/auth/signin/",{method:"POST",body:JSON.stringify({email:s.value.email,password:s.value.password}),headers:{"Content-Type":"application/json","X-CSRFToken":r.value||""},withCredentials:!0});console.log(t),w.value=t.user_id,a.value=!1,v.push("/home")}catch(t){console.error("Failed to login",t),c.value="Invalid Credentials",g(c.value)}a.value=!1},x=async()=>{try{const t=await $fetch("https://vitreous-bert-jordantimberlake-dd542edd.koyeb.app/api/token/",{method:"GET",headers:{"Content-Type":"application/json"},withCredentials:!0});r.value=t.csrfToken,console.log(t)}catch(t){console.error("Failed to fetch CSRF token",t)}},g=t=>{t=t||"An error occurred",b.add({severity:"warn",summary:"Error",detail:t,life:3e3})};return T(async()=>{await x(),console.log("token ",r.value)}),(t,n)=>(m(),u("div",E,[d(o(N)),e("div",F,[R,e("div",A,[e("form",D,[e("div",I,[L,p(e("input",{type:"email",id:"email","onUpdate:modelValue":n[0]||(n[0]=l=>o(s).email=l),required:"",class:"shadow appearance-none border rounded w-full py-2 px-3 leading-tight focus:outline-none focus:shadow-outline"},null,512),[[f,o(s).email]])]),e("div",O,[$,p(e("input",{type:"password",id:"password","onUpdate:modelValue":n[1]||(n[1]=l=>o(s).password=l),required:"",class:"shadow appearance-none border border-red rounded w-full py-2 px-3 mb-3 leading-tight focus:outline-none focus:shadow-outline"},null,512),[[f,o(s).password]])]),e("div",q,[J,d(o(V),{rounded:"",class:"font-bold py-2 px-4 w-1/2",type:"button",onClick:y},{default:j(()=>[_(" Log In ")]),_:1})])]),e("div",P,[U,o(a)?(m(),u("div",G,[d(B)])):S("",!0)])])])]))}};export{Y as default};
