import{r as i,aA as k,u as C,o as T,x as u,A as d,aB as o,y as e,J as p,aM as f,B as j,R as S,C as _,v as m}from"./BU_kieAO.js";import{u as M}from"./CT958AG4.js";import{u as h,c as V}from"./CMekXM97.js";import{c as B}from"./BZiReKcL.js";import{S as N}from"./X0EqqnIZ.js";import"./DlAUqK2U.js";const A={class:"userAuth p-10"},E={class:"w-3/5 mx-auto border border-slate-600 rounded-md p-10"},F=e("div",{class:"pb-6"},[e("h1",{class:"text-3xl font-semibold text-left"}," Log In "),e("p",{class:"text-sm"},[_("Don't have an account? "),e("a",{class:"underline",href:"/signup"},"Create an account")])],-1),R={class:"w-full flex flex-row justify-between gap-4"},D={class:"w-1/2"},I={class:"mb-4"},L=e("label",{for:"email",class:"block text-sm font-bold mb-2"},"Email",-1),O={class:"mb-4"},$=e("label",{for:"password",class:"block text-sm font-bold mb-2"},"Password",-1),q={class:"flex items-center justify-between"},J=e("a",{href:"/signup",class:"underline"},"Sign up instead",-1),P={class:"w-1/2 flex flex-col justify-start items-center gap-10"},U=e("h1",{class:"text-3xl font-semibold text-center"}," Welcome to ManagerOrg ",-1),G={key:0,class:"w-full flex justify-center items-center"},Z={__name:"login",setup(W){M({title:"Log in",description:"Manager account creation page"});const a=h("token"),w=h("user_id"),c=i(null),b=k(),n=i(!1),v=C(),s=i({email:"",password:""}),x=async()=>{n.value=!0;try{const t=await $fetch("https://vitreous-bert-jordantimberlake-dd542edd.koyeb.app/api/auth/signin/",{method:"POST",body:JSON.stringify({email:s.value.email,password:s.value.password}),headers:{"Content-Type":"application/json","X-CSRFToken":a.value||""},withCredentials:!0});console.log(t),w.value=t.user_id,n.value=!1,v.push("/home")}catch(t){console.error("Failed to login",t),c.value="Invalid Credentials",y(c.value)}n.value=!1},g=async()=>{try{const t=await $fetch("https://vitreous-bert-jordantimberlake-dd542edd.koyeb.app/api/token/",{method:"GET",headers:{"Content-Type":"application/json"},withCredentials:!0});a.value=t.csrfToken,console.log(t)}catch(t){console.error("Failed to fetch CSRF token",t)}},y=t=>{t=t||"An error occurred",b.add({severity:"warn",summary:"Error",detail:t,life:3e3})};return T(()=>{a.value===""&&g(),console.log("token ",a.value)}),(t,r)=>(m(),u("div",A,[d(o(B)),e("div",E,[F,e("div",R,[e("form",D,[e("div",I,[L,p(e("input",{type:"email",id:"email","onUpdate:modelValue":r[0]||(r[0]=l=>o(s).email=l),required:"",class:"shadow appearance-none border rounded w-full py-2 px-3 leading-tight focus:outline-none focus:shadow-outline"},null,512),[[f,o(s).email]])]),e("div",O,[$,p(e("input",{type:"password",id:"password","onUpdate:modelValue":r[1]||(r[1]=l=>o(s).password=l),required:"",class:"shadow appearance-none border border-red rounded w-full py-2 px-3 mb-3 leading-tight focus:outline-none focus:shadow-outline"},null,512),[[f,o(s).password]])]),e("div",q,[J,d(o(V),{rounded:"",class:"font-bold py-2 px-4 w-1/2",type:"button",onClick:x},{default:j(()=>[_(" Log In ")]),_:1})])]),e("div",P,[U,o(n)?(m(),u("div",G,[d(N)])):S("",!0)])])])]))}};export{Z as default};
