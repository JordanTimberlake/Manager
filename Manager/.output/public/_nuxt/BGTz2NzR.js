import{r as i,aA as k,u as C,o as T,x as u,A as c,aB as s,y as e,J as p,aM as f,B as S,R as M,C as _,v as m}from"./CS3_mnPD.js";import{u as V}from"./DNZMkAnO.js";import{u as h,c as j}from"./DbKvMxRP.js";import{c as B}from"./BjlN2r8C.js";import{S as N}from"./p-mV6gvn.js";import"./DlAUqK2U.js";const A={class:"userAuth p-10"},E={class:"w-3/5 mx-auto border border-slate-600 rounded-md p-10"},F=e("div",{class:"pb-6"},[e("h1",{class:"text-3xl font-semibold text-left"}," Log In "),e("p",{class:"text-sm"},[_("Don't have an account? "),e("a",{class:"underline",href:"/signup"},"Create an account")])],-1),R={class:"w-full flex flex-row justify-between gap-4"},D={class:"w-1/2"},I={class:"mb-4"},L=e("label",{for:"email",class:"block text-sm font-bold mb-2"},"Email",-1),O={class:"mb-4"},P=e("label",{for:"password",class:"block text-sm font-bold mb-2"},"Password",-1),$={class:"flex items-center justify-between"},q=e("a",{href:"/signup",class:"underline"},"Sign up instead",-1),J={class:"w-1/2 flex flex-col justify-start items-center gap-10"},U=e("h1",{class:"text-3xl font-semibold text-center"}," Welcome to ManagerOrg ",-1),G={key:0,class:"w-full flex justify-center items-center"},Z={__name:"login",setup(W){V({title:"Log in",description:"Manager account creation page"});const a=h("token"),w=h("user_id"),d=i(null),v=k(),n=i(!1),x=C(),t=i({email:"",password:""}),b=async()=>{n.value=!0;try{const o=await $fetch("http://localhost:8000/api/auth/signin/",{method:"POST",body:JSON.stringify({email:t.value.email,password:t.value.password}),headers:{"Content-Type":"application/json","X-CSRFToken":a.value||""},credentials:"include"});console.log(o),w.value=o.user_id,n.value=!1,x.push("/home")}catch(o){console.error("Failed to login",o),d.value="Invalid Credentials - Please check your email and password",y(d.value)}n.value=!1},g=async()=>{try{const o=await $fetch("http://localhost:8000/api/token/",{method:"GET",credentials:"include"});a.value=o.csrfToken,console.log(o)}catch(o){console.error("Failed to fetch CSRF token",o)}},y=o=>{o=o||"An error occurred",v.add({severity:"warn",summary:"Error",detail:o,life:3e3})};return T(()=>{a.value===""&&g(),console.log("token ",a.value)}),(o,l)=>(m(),u("div",A,[c(s(B)),e("div",E,[F,e("div",R,[e("form",D,[e("div",I,[L,p(e("input",{type:"email",id:"email","onUpdate:modelValue":l[0]||(l[0]=r=>s(t).email=r),required:"",class:"shadow appearance-none border rounded w-full py-2 px-3 leading-tight focus:outline-none focus:shadow-outline"},null,512),[[f,s(t).email]])]),e("div",O,[P,p(e("input",{type:"password",id:"password","onUpdate:modelValue":l[1]||(l[1]=r=>s(t).password=r),required:"",class:"shadow appearance-none border border-red rounded w-full py-2 px-3 mb-3 leading-tight focus:outline-none focus:shadow-outline"},null,512),[[f,s(t).password]])]),e("div",$,[q,c(s(j),{rounded:"",class:"font-bold py-2 px-4 w-1/2",type:"button",onClick:b},{default:S(()=>[_(" Log In ")]),_:1})])]),e("div",J,[U,s(n)?(m(),u("div",G,[c(N)])):M("",!0)])])])]))}};export{Z as default};
